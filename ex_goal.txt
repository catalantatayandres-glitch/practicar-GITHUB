üéØ Objetivos a resolver
1Ô∏è‚É£ A√±adir columna VAF (Variant Allele Frequency)

F√≥rmula:

VAF = alt_count / depth


Debe ser float entre 0 y 1.

2Ô∏è‚É£ Filtrar mutaciones confiables

Conserva SOLO filas donde:

depth ‚â• 30

VAF ‚â• 0.1

(Esto simula filtros est√°ndar en exoma y paneles cl√≠nicos.)

3Ô∏è‚É£ Contar mutaciones por gene y por sample

A√±ade columnas:

gene_mut_count ‚Üí cu√°ntas mutaciones tiene cada gen

sample_mut_count ‚Üí cu√°ntas mutaciones tiene cada muestra

Usa groupby + transform (muy importante en bioinform√°tica).

Ejemplo:

df["gene_mut_count"] = df.groupby("gene")["gene"].transform("count")

4Ô∏è‚É£ Crear matriz de mutaciones (samples √ó genes)

Salida esperada tipo mutation matrix, igual a las de cBioPortal o PCAWG:

       BRCA1   TP53    MYC
S1       2       0      0
S2       1       1      0
S3       1       0      1


Pista:

matrix = df.pivot_table(index="sample", columns="gene", values="pos", aggfunc="count", fill_value=0)

5Ô∏è‚É£ Detectar hotspots

Define hotspot como posiciones con ‚â• 2 mutaciones en distintos samples.

Genera:

hotspots = df.groupby(["gene","pos"]).size()


Filtra valores ‚â• 2.

‚úîÔ∏è Resultados esperados

Tu script debe imprimir:

El DataFrame final filtrado y anotado

La mutation matrix

La lista de hotspots detectados